<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	th:replace="~{/admin/layout/layout :: content(~{::body},~{::title})}">
<head>
<title>Danh sách tài khoản quản lý đã bị khóa</title>
</head>
<body>
	<!-- Page Content-->
	<div class="page-content" >
		<div class="container-fluid">
			<!-- Page-Title -->
			<div class="row">
				<div class="col-sm-12">
					<div class="page-title-box">
						<div class="row">
							<div class="col">
								<h4 class="page-title">Danh Sách Tài Khoản Quản Lý Đã Bị Khóa</h4>
							</div>
							<!--end col-->
							<div class="col-auto align-self-center">
								<a href="#" class="btn btn-sm btn-outline-primary"
									id="Dash_Date"> <span class="day-name" id="Day_Name">Today:</span>&nbsp;
									<span class="" id="Select_date">Jan 11</span> <i
									data-feather="calendar" class="align-self-center icon-xs ms-1"></i>
								</a> <a href="#" class="btn btn-sm btn-outline-primary"> <i
									data-feather="download" class="align-self-center icon-xs"></i>
								</a>
							</div>
							<!--end col-->
						</div>
						<!--end row-->
					</div>
					<!--end page-title-box-->
				</div>
				<!--end col-->
			</div>
			<!--end row-->
			<!-- end page title end breadcrumb -->
			<div class="row">
				<div class="col-12"  >
					<div class="card" >
						
						<!--end card-header-->
						<div class="card-body">
						
						

  
   <table id="datatable-buttons"
                                class="table table-striped table-bordered dt-responsive nowrap"
                                style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                <thead>
                                    <tr>
                                        <th>Hình ảnh</th>
                                        <th>Tên Đăng Nhập</th>
                                        <th>Họ Tên</th>
                                        <th>Địa Chỉ</th>
                                        <th>Email</th>
                                        <th>Số Điện Thoại</th>
                                        <th>Ngày Tạo</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody id="datatable-container">
                                    <!-- Thymeleaf loop to iterate over the list of accounts -->
                                    <tr th:each="taiKhoanAdminLock : ${taiKhoanAdminListLock}">
                                        <td><img th:src="@{'/images/avatar/' +${taiKhoanAdminLock.hinhAnh}}" alt="" class="rounded-circle thumb-xs me-1"></td>
                                        <td th:text="${taiKhoanAdminLock.tenDangNhap}"></td>
                                        <td th:text="${taiKhoanAdminLock.hoTen}"></td>
                                        <td th:text="${taiKhoanAdminLock.diaChi}"></td>
                                        <td th:text="${taiKhoanAdminLock.email}"></td>
                                        <td th:text="${taiKhoanAdminLock.soDienThoai}"></td>
                                        <td th:text="${taiKhoanAdminLock.ngayTao}"></td>
                                        <td class="text-right">
                                            <div class="dropdown d-inline-block">
                                                <a class="dropdown-toggle arrow-none" id="dLabel11" data-bs-toggle="dropdown"
                                                    href="#" role="button" aria-haspopup="false" aria-expanded="false">
                                                    <i class="las la-ellipsis-v font-20 text-muted"></i>
                                                </a>
                                                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dLabel11">
<!--                                                     <a class="dropdown-item" href="#">Xóa tài khoản</a> -->
                                                    
                                                     <a class="dropdown-item lock-account" th:data-account-id="${taiKhoanAdminLock.tenDangNhap}" href="#">Mở khóa tài khoản</a>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
  
  
  
<!--   <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">...</div> -->
</div>



							
						</div>
					</div>
				</div>
				<!-- end col -->
			</div>
			<!-- end row -->
		</div>
		<!-- container -->
		<footer class="footer text-center text-sm-start">
			&copy;
			<script>
				document.write(new Date().getFullYear())
			</script>
			Dastone <span class="text-muted d-none d-sm-inline-block float-end">Crafted
				with <i class="mdi mdi-heart text-danger"></i> by Mannatthemes
			</span>
		</footer>
		<!--end footer-->
	<!-- end page content -->
	
	
	<div th:each="taiKhoanAdminLock : ${taiKhoanAdminListLock}">
    <div class="modal fade" th:id="'confirmationModal-' + ${taiKhoanAdminLock.tenDangNhap}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Xác nhận</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    Bạn có chắc chắn muốn khóa tài khoản này?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
                    <button type="button" class="btn btn-primary confirmLock" th:data-account-id="${taiKhoanAdminLock.tenDangNhap}">Yes</button>
                </div>
            </div>
        </div>
    </div>
</div>
	
		<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script th:inline="javascript">
    // Your existing JavaScript code
    $(document).on('click', '.lock-account', function (e) {
        e.preventDefault();
        accountIdToLock = $(this).data('account-id');
        var modalSelector = '#confirmationModal-' + accountIdToLock;
        $(modalSelector).modal('show');
    });

    $(document).on('click', '.confirmLock', function () {
        var accountIdToLock = $(this).data('account-id');
        var modalSelector = '#confirmationModal-' + accountIdToLock;
        $(modalSelector).modal('hide');

        // Send an AJAX request to the server to lock the account
        $.ajax({
            type: 'POST',
            url: '/admin/listAccountLockAdmin',
            data: {accountId: accountIdToLock},
            success: function (response) {
                if (response === 'success') {
                    // Update the UI or perform any other action
                    reloadDataTableContent();
                } else {
                    alert('Failed to lock account. Please try again.');
                }
            },
            error: function () {
                alert('Error occurred while processing the request.');
            }
        });
    });

    function reloadDataTableContent() {
        // Fetch and update the table content dynamically
        $.get('/admin/listAccountAdminLock', function (data) {
            // Replace the existing table content with the updated content
            $('#datatable-container').html($(data).find('#datatable-container').html());
        });
    }
</script>
</body>

</html>